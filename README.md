**Parallel Programming**  
**Ã…bo Akademi University, Information Technology Department**  
**Instructor: Alireza Olama**

**Homework Assignment 3: Matrix Multiplication with CUDA**

**Due Date**: **31/05/2025**  
**Points**: 100

---

## Performance Measurement

### Block size = 32, OMP_NUM_THREADS = 2, Tile size = 16

| Test Case | Dimensions (\( m \times n \times p \)) | Naive CPU (s) | Blocked CPU (s) | Parallel CPU (s) | Naive CUDA (s) | Tiled CUDA (s) | Tiled CUDA Speedup (vs. Naive CUDA) | Tiled CUDA Speedup (vs. Parallel CPU) |
|-----------|----------------------------------------|---------------|-----------------|------------------|----------------|----------------|-------------------------------------|---------------------------------------|
| 0         | 64 x 64 x 64           | 0.00100017     | 0.00100017       | 0.00200009        |  0.0227328      |  0.0161792       |  1.40506x  | 0.12362x |
| 1         | 128 x 64 x 128         | 0.00200009     | 0.00199986       | 0.00199986        |  0.0280576      |  0.0188416       |  1.48913x  | 0.10614x |
| 2         | 100 x 128 x 56         | 0.00199986     | 0.00100017       | 0.00100017        |  0.0241664      |  0.0155648       |  1.55263x  | 0.06426x |
| 3         | 128 x 64 x 128         | 0.00300002     | 0.00300002       | 0.00100017        |  0.0274432      |  0.0198656       |  1.38144x  | 0.05035x |
| 4         | 32 x 128 x 32          | 0              | 0                | 0.00200009        |  0.0233472      |  0.0149504       |  1.56164x  | 0.13378x |
| 5         | 200 x 100 x 256        | 0.0109999      | 0.0149999        | 0.00199986        |  0.0589632      |  0.0393984       |  1.49659x  | 0.05076x |
| 6         | 256 x 256 x 256        | 0.0380001      | 0.04             | 0.00600004        |  0.149901       |  0.0890048       |  1.68419x  | 0.06741x |
| 7         | 256 x 300 x 256        | 0.0470002      | 0.0500002        | 0.00900006        |  0.17111        |  0.104224        |  1.64176x  | 0.08635x |
| 8         | 64 x 128 x 64          | 0.00100017     | 0.000999928      | 0.00299978        |  0.0278528      |  0.0182272       |  1.52809x  | 0.16458x |
| 9         | 256 x 256 x 257        | 0.0350001      | 0.0410001        | 0.00699997        |  0.157043       |  0.0924416       |  1.69884x  | 0.07572x |

---

### Block size = 32, OMP_NUM_THREADS = 2, Tile size = 32

| Test Case | Dimensions (\( m \times n \times p \)) | Naive CPU (s) | Blocked CPU (s) | Parallel CPU (s) | Naive CUDA (s) | Tiled CUDA (s) | Tiled CUDA Speedup (vs. Naive CUDA) | Tiled CUDA Speedup (vs. Parallel CPU) |
|-----------|----------------------------------------|---------------|-----------------|------------------|----------------|----------------|-------------------------------------|---------------------------------------|
| 0         | 64 x 64 x 64           | 0.00100017     | 0.00100017       | 0.00200009        |  0.024576       |  0.0190464       |  1.29032x  | 0.10501x |
| 1         | 128 x 64 x 128         | 0.00200009     | 0.00199986       | 0.00199986        |  0.031744       |  0.0202752       |  1.56566x  | 0.09866x |
| 2         | 100 x 128 x 56         | 0.00199986     | 0.00100017       | 0.00100017        |  0.0311296      |  0.0210944       |  1.47573x  | 0.04741x |
| 3         | 128 x 64 x 128         | 0.00300002     | 0.00300002       | 0.00100017        |  0.0268288      |  0.0186368       |  1.43956x  | 0.05367x |
| 4         | 32 x 128 x 32          | 0              | 0                | 0.00200009        |  0.0311296      |  0.0202752       |  1.53535x  | 0.09865x |
| 5         | 200 x 100 x 256        | 0.0109999      | 0.0149999        | 0.00199986        |  0.0488832      |  0.035296        |  1.38495x  | 0.05666x |
| 6         | 256 x 256 x 256        | 0.0380001      | 0.04             | 0.00600004        |  0.148512       |  0.0826432       |  1.79703x  | 0.0726x  |
| 7         | 256 x 300 x 256        | 0.0470002      | 0.0500002        | 0.00900006        |  0.134701       |  0.078944        |  1.70628x  | 0.114x   |
| 8         | 64 x 128 x 64          | 0.00100017     | 0.000999928      | 0.00299978        |  0.0309248      |  0.0206848       |  1.49505x  | 0.14502x |
| 9         | 256 x 256 x 257        | 0.0350001      | 0.0410001        | 0.00699997        |  0.173805       |  0.0956608       |  1.81689x  | 0.07317x |

### Conclusion

- Tiled CUDA is faster than Naive CUDA for all test cases and tile size. The speed up ranges from 1.3x to 1.8x.
- CUDA is slower than CPU implementations, especially compared to the Parallel CPU. Parallel CPU is the fastest in almost all cases.
- Tile size 32 gives slightly better speedup for Tiled CUDA compared to tile size 16 in most cases.